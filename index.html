<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ログインページ</title>

  <!-- Auth0 SDK を先に読み込む（超重要） -->
  <script src="https://cdn.auth0.com/js/auth0-spa-js/2.5/auth0-spa-js.production.browser.js"></script>

  <script>
    let auth0Client;

    async function init() {
      // ボタンを一時的に無効化
      document.getElementById("login-btn").disabled = true;

      // Auth0 SDK が読み込まれているかチェック
      console.log("createAuth0Client:", typeof createAuth0Client);

      // Auth0 クライアントを作成
      auth0Client = await createAuth0Client({
        domain: "tera-corp.jp.auth0.com",
        client_id: "9Po9tdWjKM5QIMqKrCKJmeaX2udjZl1j",
        authorizationParams: {
          redirect_uri: "https://24xxl.github.io/home/"
        }
      });

      const isAuth = await auth0Client.isAuthenticated();

      if (isAuth) {
        window.location.href = "https://24xxl.github.io/home/";
        return;
      }

      // 初期化完了
      document.getElementById("login-btn").disabled = false;
    }

    async function login() {
      await auth0Client.loginWithRedirect();
    }

    window.onload = init;
  </script>
</head>

<body>
  <h1>ようこそ</h1>
  <p>ログインすると専用ページを閲覧できます。</p>

  <button id="login-btn" onclick="login()">ログイン</button>
</body>
</html>
